name: Auto Generate Daily Post for NFTGameAI

on:
  # T·ª± ƒë·ªông ch·∫°y m·ªói ng√†y l√∫c 9h s√°ng (UTC) = 16h Vi·ªát Nam
  schedule:
    - cron: "0 9 * * *"
  # Cho ph√©p ch·∫°y th·ªß c√¥ng trong tab Actions
  workflow_dispatch:

permissions:
  contents: write  # ‚ö° Cho ph√©p GitHub Actions push l√™n repo

jobs:
  autogen:
    runs-on: ubuntu-latest

    steps:
      # --- 1. Clone m√£ ngu·ªìn ---
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          persist-credentials: true   # ‚ö° D√πng GITHUB_TOKEN ƒë·ªÉ push

      # --- 2. Setup Python ---
      - name: Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.11"

      # --- 3. C√†i th∆∞ vi·ªán c·∫ßn thi·∫øt ---
      - name: Install dependencies
        run: pip install requests

      # --- 4. T·∫°o b√†i vi·∫øt m·ªõi ---
      - name: Generate new post
        run: python3 auto_generate.py

      # --- 5. Commit & Push l√™n main ---
      - name: Commit and push
        run: |
          git config --global user.name "AutoPublisher"
          git config --global user.email "auto@users.noreply.github.com"

          git add _posts || true
          if git diff --cached --quiet; then
            echo "‚úÖ Kh√¥ng c√≥ thay ƒë·ªïi m·ªõi, kh√¥ng commit."
          else
            git commit -m "üß† Auto new post $(date -u +'%Y-%m-%d %H:%M UTC')"
            git push origin main
            echo "‚úÖ ƒê√£ push b√†i vi·∫øt m·ªõi th√†nh c√¥ng!"
          fi
